---
title: Troubleshooting
page-title: Troubleshooting for Vaadin Control Center
description: Troubleshooting tips for Control Center.
meta-description: Learn about how to fix problems that may happen when using Vaadin's Control Center tool.
order: 80
---


= Troubleshooting

When installing Control Center or deploying an application using Control Center, you may encounter issues that are not caused by Control Center itself, but by external factors such as cluster resource limits, DNS propagation delays, or misconfigured dependencies.

== 503 Service Temporarily Unavailable

When trying to access Control Center (or any deployed application) with your web browser and are greeted with a `503 Service Temporarily Unavailable` error page, the application might not be running and available.
You can see the logs of deployed applications in the Control Center logs screen.
To check the status of Control Center itself, you can print the logs by running:

[source,shell]
----
# assuming your deployment is named 'control-center'
kubectl -n <namespace> logs -f deployment/control-center
----

If the logs show normal startup messages, then you might only need to wait until the deployment becomes available.
If a specific error is shown in the logs, address it accordingly. If no specific error is shown in the logs, check the Kubernetes events in the namespace where Control Center was installed.

[source,shell]
----
kubectl -n <namespace> events
----

For deployed applications, if you see events of failing probes, then xref:../application-deployment/index.adoc#deploy-with-control-center[increase the startup delay time] enough to give it time to finish.
If Control Center itself has failing probe events, try upgrading the installation with an extra setting increasing the startup delay time.

[source,shell]
----
helm upgrade control-center oci://docker.io/vaadin/control-center -n control-center \
--reuse-values \
--set app.startupProbe.initialDelaySeconds=30
----

== Insufficient Cluster Resources

When Control Center instance is slow to respond it might be because of lacking enough resources (CPU, memory).
You can check resource allocation using:

[source,shell]
----
kubectl describe node
----

image::images/describe_node.png[Describe node example]

The above command shows a lot of information about a kubelet, including memory pressure, disk pressure, PID, and the percentage of allocated resources.

=== Solution

Make sure there are enough resources allocated for your kubelet, and if not, then increase the node capabilities on your cloud provider.
You can also try increasing resource requests of Control Center by upgrading with `helm` and setting certain values.

[source,shell]
----
helm upgrade control-center oci://docker.io/vaadin/control-center -n control-center \
--reuse-values \
--set app.resources.requests.cpu=2 \
--set app.resources.requests.memory=512Mi
----

This example modifies the Control Center deployment with a CPU request of 2 CPU and a memory request of 512 MiB of memory.

== DNS Record Propagation Delays

DNS propagation refers to the process of updating information on the internet's DNS (Domain Name System) servers.
DNS servers are responsible for the mapping of domain names to IP addresses. 
In essence, DNS propagation is the time required for DNS servers worldwide to update their cached information for a domain name.

DNS propagation can take some time to complete because it involves updating information on many servers across the internet.
DNS records, like IP addresses, must be updated on all servers resolving your domain name.
Even after making a change, some servers may still have outdated information, leading to inconsistencies in DNS resolution and longer propagation times.

=== Solution

Verify DNS records of your domain are ready and available.
To check the IP address a domain resolves to, run:

[source,shell]
----
nslookup <domain>
----

Expect your server's IP address to be shown when running `nslookup`.

image::images/nslookup_vaadin.png[dnslookup vaadin.com]

You can also try to ping your domain:

[source,shell]
----
ping -t 4 <domain>
----

The ping is only successful if the domain name can be resolved to an IP address.

If the lookup cannot resolve the hostname into an IP address, double-check for typos.
If the DNS server can't find the domain, then it is yet to be propagated.
The time it takes for a domain to propagate is unpredictable; it can take from just a few minutes up to 24 hours, or even more.

Double-check the DNS configuration within your cloud provider and verify that the domain is correct.
You can also manually associate the server's IP address with the desired domain by adding it to xref:../getting-started/local-environment#configure-hosts-file[your `hosts` file].

Another symptom of this problem is that the public key certificates might not be ready.
You can check if the certificates are still being requested by running:

[source,shell]
----
kubectl -n control-center get certificaterequests
----

When certificates are ready, the output of the above command should look like this:

image::images/check_certificates_status.png[Check Certificates Status]


== Invalid Docker Image

An application deployed with Control Center with an invalid image reference won't ever become available.
In this situation, trying to access the logs fails with an error saying that the image can't be pulled.
Since there is no valid image there also isn't a valid deployment to get logs from.
A docker image reference consists of several components that describe where the image is stored and its identity. These components are:

```
[HOST[:PORT]/]NAMESPACE/REPOSITORY[:TAG]
```

`HOST` +
Specifies the registry location where the image resides. If omitted, Docker defaults to Docker Hub (`docker.io`).

`PORT` +
An optional port number for the registry, if necessary (for example, `:5000`).

`NAMESPACE/REPOSITORY` +
The namespace (optional) usually represents a user or organization. The repository is required and identifies the specific image. If the namespace is omitted, Docker defaults to `library`, the namespace reserved for Docker Official Images.

`TAG` +
An optional identifier used to specify a particular version or variant of the image. If no tag is provided, Docker defaults to `latest`.

If an invalid docker image is used to deploy an application, the application may never become available.
To check if an unavailable application has an invalid image, look for a Warning event with the message `Failed to pull image...`

[source,shell]
----
kubectl -n <namespace> events --types=Warning
----

image::images/docker_image_not_found.png[Docker image not found]

If the image is hosted in a private repository, you might need to provide an image pull secret as necessary authentication to pull the image.
This value can be provided in the application deploy screen, below the field where the docker image is provided.


== Install Control Center in WSL

One of the possible solutions to install Control Center on Windows in a local environment is to use https://www.docker.com/products/docker-desktop[Docker Desktop] and https://learn.microsoft.com/en-us/windows/wsl[WSL] (Windows Subsystem for Linux). First you need to https://learn.microsoft.com/en-us/windows/wsl/install[install] the WSL. It is important to choose a distribution during the installation where Helm can be installed:

[source,shell]
----
wsl --install -d <Distribution Name>
----

One option is to use the Ubuntu distribution:
[source,shell]
----
wsl --install -d Ubuntu
----

Then you need to enable the Kubernetes and WSL built-in engines in the Docker Desktop:

image::images/enable_kubernetes.png[Enable Kubernetes]

image::images/enable_wsl.png[Enable WSL]

You also need to enable the integration with the Ubuntu distribution in the Docker Desktop:

image::images/enable_ubuntu_distribution.png[Enable Ubuntu Distribution]

Then you can start the WSL with the following command using the distribution you chose before, in this case the Ubuntu:

[source,shell]
----
wsl.exe -d Ubuntu
----

After you need to use the WSL terminal to install Helm and Control Center. First,  you need to https://helm.sh/docs/intro/install/#from-apt-debianubuntu[install] Helm before you can start to xref:../getting-started/local-environment#deploying_control_center[install] Control Center in the local environment with the command:

[source,bash]
----
helm install control-center oci://docker.io/vaadin/control-center \
    -n control-center --create-namespace \
    --set domain=local \
    --set user.email=example@foo.com \
    --wait
----

It is important to xref:../getting-started/local-environment#windows[update] the `hosts` file on the Windows system (e.g. C:\Windows\System32\drivers\etc\hosts) with the domain you used during the Control Center installation, in this case with the `control.local` and `auth.local` domains:

[source,text]
----
# Added by Docker Desktop:
192.168.31.179 host.docker.internal
192.168.31.179 gateway.docker.internal
# Added by Docker Desktop to allow the same kube context to work on the host and the container:
127.0.0.1 kubernetes.docker.internal
# You need to add these entries:
127.0.0.1 control.local
127.0.0.1 auth.local
----

Note that there are other entries added to the `hosts` file which are also important. Those should be added automatically by the Docker Desktop when the Kubernetes and WSL engines are enabled.
